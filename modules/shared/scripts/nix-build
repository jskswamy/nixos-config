#!/usr/bin/env bash
set -e

build_nix_config() {
  local config_dir="$HOME/nixos-config"

  if [ ! -d "$config_dir" ]; then
    gum style --foreground 196 "Error: nixos-config directory not found at $config_dir"
    exit 1
  fi

  cd "$config_dir"
  if gum spin --spinner dot --title "Building nix configuration..." -- nix run .#build; then
    gum style --foreground 46 "✓ Nix configuration built successfully!"
  else
    gum style --foreground 196 "✗ Build failed"
    exit 1
  fi
}

main() {
  build_nix_config
}

main "$@"
